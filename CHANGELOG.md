# 更新日志

## 2024-12-30: AI Agent 回答改进

### 🎯 主要改进

让 AI Agent 的回答更自然、友好、鲁棒。

### ✨ 改进内容

1. **系统提示词优化**
   - 添加详细的性格设定（友好、对话式）
   - 明确沟通风格要求
   - 添加格式化和展示要求
   - 改进错误处理指导

2. **温度参数调整**
   - 从 `0` 提高到 `0.7`（更自然的回答）
   - 可通过 `LLM_TEMPERATURE` 环境变量配置

3. **工具调用后友好回复生成**
   - 工具执行后，LLM 会生成友好的用户回复
   - 不再直接返回原始工具输出
   - 自动格式化工具结果

4. **改进错误处理**
   - 使用 LLM 生成友好的错误解释
   - 提供解决建议
   - 更友好的错误信息

5. **循环处理工具调用**
   - 支持多次工具调用
   - 防止无限循环（最大 5 次迭代）
   - 更好的工具结果累积

### 🔧 技术变更

- `src/agent.ts`: 重构 `chat()` 方法，改进工具调用处理
- `src/agent.ts`: 添加 `formatToolResult()` 方法
- `src/agent.ts`: 优化系统提示词
- `src/config.ts`: 添加 `temperature` 配置项

### 📝 配置变更

新增环境变量（可选）：
```bash
LLM_TEMPERATURE=0.7  # 0-2，默认 0.7
```

### 📖 使用说明

详细说明请查看 `IMPROVEMENTS.md`

